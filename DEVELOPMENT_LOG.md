# VideoMapping é¡¹ç›®å¼€å‘æ—¥å¿—

## é¡¹ç›®ä¿¡æ¯
- **å¼€å‘å¹³å°**: Rock 5C (ARM64 æ¶æ„)
- **æ“ä½œç³»ç»Ÿ**: Linux 6.1.43-15-rk2312
- **CPUç±»å‹**: ARM64 (RK3588s)
- **å¼€å‘ç¯å¢ƒ**: SSHè¿œç¨‹å¼€å‘

---

## 2024-12-19 - å•åº”æ€§çŸ©é˜µæ ‡å®šç•Œé¢ä¼˜åŒ–

### ğŸ¯ **æ ¸å¿ƒé—®é¢˜**
- å…¨å±æŒ‰é’®ç‚¹å‡»è¢«è¯¯è¯†åˆ«ä¸ºå›¾åƒç‚¹å‡»äº‹ä»¶
- 1920Ã—1080åˆ†è¾¨ç‡ä¿æŒå¯¹å•åº”æ€§çŸ©é˜µè®¡ç®—ç²¾åº¦è‡³å…³é‡è¦
- ç•Œé¢å…ƒç´ å¹²æ‰°æ ‡å®šè¿‡ç¨‹

### âœ… **è§£å†³æ–¹æ¡ˆ**
1. **ç§»é™¤è§†è§‰å¹²æ‰°å…ƒç´ **
   - å®Œå…¨éšè—æ ‡å®šæ¨¡å¼ä¸‹çš„å…¨å±æŒ‰é’®
   - æ¸…ç†æ‰€æœ‰æµ®åŠ¨è¦†ç›–æ§ä»¶
   - ä¿æŒç”»é¢å®Œå…¨æ´å‡€

2. **ä¿ç•™å¿«æ·é”®æ“ä½œ**
   - F11: åˆ‡æ¢å…¨å±æ¨¡å¼
   - ESC: é€€å‡ºå…¨å±æ¨¡å¼
   - é”®ç›˜æ“ä½œä¸å½±å“ç”»é¢ç‚¹å‡»

3. **å¼ºåŒ–ç”¨æˆ·æŒ‡å¯¼**
   - å¼ºè°ƒ1920Ã—1080åˆ†è¾¨ç‡çš„é‡è¦æ€§
   - æ›´æ–°æ ‡å®šæç¤ºä¿¡æ¯
   - å¢å¼ºå…¨å±æ¨¡å¼çš„æ“ä½œæŒ‡å¯¼

### ğŸ”§ **æŠ€æœ¯å®ç°**
```javascript
// æ ‡å®šæ¨¡å¼ä¸‹å®Œå…¨éšè—æµ®åŠ¨å…ƒç´ 
if (this.calibrationMode) {
    fullscreenContainer.style.display = 'none';
    videoOverlayControls.style.display = 'none';
}
```

### ğŸ“ **åˆ†è¾¨ç‡ä¿è¯æªæ–½**
- æ˜ç¡®æ ‡æ³¨1920Ã—1080è¦æ±‚
- åœ¨å¤šä¸ªæç¤ºä½ç½®å¼ºè°ƒåˆ†è¾¨ç‡é‡è¦æ€§
- å…¨å±æ¨¡å¼æç¤ºæ˜¾ç¤ºåˆ†è¾¨ç‡ä¿¡æ¯

### ğŸ® **ç”¨æˆ·ä½“éªŒæ”¹è¿›**
- å®Œå…¨æ´å‡€çš„æ ‡å®šç”»é¢
- ç›´è§‚çš„å¿«æ·é”®æ“ä½œ
- æ¸…æ™°çš„æ“ä½œæµç¨‹æŒ‡å¯¼
- å‡å°‘è¯¯æ“ä½œå¯èƒ½æ€§

### âš¡ **æ€§èƒ½ä¼˜åŒ–**
- å‡å°‘DOMå…ƒç´ å¤„ç†
- ç®€åŒ–äº‹ä»¶ç›‘å¬
- æé«˜ç‚¹å‡»å“åº”ç²¾åº¦

---

## 2024-12-19 - æ‘„åƒå¤´åˆ†è¾¨ç‡ä¸åŒ¹é…é—®é¢˜ä¿®å¤

### ğŸš¨ **é—®é¢˜æ ¹æº**
- **æ‘„åƒå¤´ç¡¬ä»¶é™åˆ¶**: æ‘„åƒå¤´ä¸æ”¯æŒ1920x1080ï¼Œåªèƒ½è¿è¡Œåœ¨640x480
- **åˆ†è¾¨ç‡éªŒè¯ç¼ºå¤±**: ç¨‹åºæœªæ­£ç¡®æ£€æµ‹åˆ†è¾¨ç‡è®¾ç½®å¤±è´¥
- **æœŸæœ›ä¸ç°å®ä¸ç¬¦**: ç¨‹åºæœŸæœ›1920x1080ä½†æ‘„åƒå¤´å®é™…è¿è¡Œ640x480
- **è¿ç»­å¸§è¯»å–å¤±è´¥**: åˆ†è¾¨ç‡ä¸åŒ¹é…å¯¼è‡´OpenCVå¤„ç†å¼‚å¸¸

### âœ… **ä¿®å¤æªæ–½**
1. **åŠ å¼ºåˆ†è¾¨ç‡éªŒè¯**
   - ä¸¥æ ¼æ£€æµ‹åˆ†è¾¨ç‡è®¾ç½®æ˜¯å¦æˆåŠŸ
   - å½“æ‘„åƒå¤´ä¸æ”¯æŒç›®æ ‡åˆ†è¾¨ç‡æ—¶ç»™å‡ºæ˜ç¡®è­¦å‘Š
   - è‡ªåŠ¨é€‚é…åˆ°æ‘„åƒå¤´å®é™…æ”¯æŒçš„åˆ†è¾¨ç‡

2. **æ”¹è¿›è¯Šæ–­ä¿¡æ¯**
   - å¯åŠ¨æ—¶æ£€æŸ¥æ‘„åƒå¤´æ”¯æŒçš„æ‰€æœ‰åˆ†è¾¨ç‡
   - æ¸…æ™°æ˜¾ç¤ºåˆ†è¾¨ç‡è®¾ç½®è¿‡ç¨‹
   - åŒºåˆ†æœŸæœ›åˆ†è¾¨ç‡å’Œå®é™…åˆ†è¾¨ç‡

3. **æ™ºèƒ½é™çº§ç­–ç•¥**
   - å½“é«˜åˆ†è¾¨ç‡ä¸å¯ç”¨æ—¶è‡ªåŠ¨é™çº§
   - ä¿æŒç³»ç»Ÿç¨³å®šè¿è¡Œ
   - ä¼˜åŒ–å†…å­˜å’Œæ€§èƒ½

### ğŸ”§ **ä»£ç å˜æ›´**
```cpp
// ä¿®å¤å‰: é™é»˜å¤±è´¥
cap_.set(cv::CAP_PROP_FRAME_WIDTH, width);

// ä¿®å¤å: ä¸¥æ ¼éªŒè¯ + è‡ªåŠ¨é€‚é…
if (abs(actual_width - width) > 50) {
    cout << "âš ï¸ åˆ†è¾¨ç‡ä¸æ”¯æŒï¼Œè‡ªåŠ¨è°ƒæ•´";
    detectionWidth_ = actual_width;
}
```

---

## 2024-12-19 - OpenCV Matå¯¹è±¡å¼‚å¸¸ä¿®å¤

### ğŸ› **è‡´å‘½Bugå‘ç°**
åˆ†è¾¨ç‡ä¿®å¤åå‡ºç°æ–°é—®é¢˜ï¼š
```
cv::Exception: Unknown array type in function 'cvarrToMat'
```

### ğŸ•µï¸ **é—®é¢˜åˆ†æ**
åœ¨åŒåˆ†è¾¨ç‡å¸§å¤„ç†é€»è¾‘ä¸­ï¼š
```cpp
frame_ = std::move(processedFrame);  // frameç§»åŠ¨åå˜ç©º
frame.copyTo(detectionFrame_);       // ä½¿ç”¨ç©ºçš„frameå¯¼è‡´å¼‚å¸¸
```

### âœ… **ä¿®å¤æ–¹æ¡ˆ**
```cpp
// ä¿®å¤å‰ï¼šå¤æ‚çš„å…±äº«é€»è¾‘ï¼Œå®¹æ˜“å‡ºé”™
if (cameraCalibrationMode_) {
    frame.copyTo(detectionFrame_);  // frameå·²è¢«moveï¼Œä¸ºç©º
}

// ä¿®å¤åï¼šç®€åŒ–ä¸ºå®‰å…¨çš„æ·±åº¦å¤åˆ¶
frame_ = std::move(processedFrame);
detectionFrame_ = frame_.clone();   // å®‰å…¨å¯é 
```

### ğŸ¯ **æµ‹è¯•ç»“æœ**
- âœ… åˆ†è¾¨ç‡æ­£ç¡®è®¾ç½®ä¸º1920x1080
- âœ… æ‘„åƒå¤´æ”¯æŒæ£€æµ‹æ­£å¸¸å·¥ä½œ
- ğŸ”„ ç­‰å¾…éªŒè¯Matå¼‚å¸¸æ˜¯å¦å®Œå…¨è§£å†³

---

## ä¸‹ä¸€æ­¥è®¡åˆ’
- [ ] æµ‹è¯•OpenCVå¼‚å¸¸ä¿®å¤æ•ˆæœ
- [ ] éªŒè¯ARM64å¹³å°æ€§èƒ½æ”¹å–„
- [ ] æµ‹è¯•æ ‡å®šç²¾åº¦æ”¹è¿›æ•ˆæœ
- [ ] éªŒè¯å¿«æ·é”®æ“ä½œæµç•…æ€§
- [ ] æ”¶é›†ç”¨æˆ·ä½¿ç”¨åé¦ˆ

---

*æœ€åæ›´æ–°: 2024-12-19* 